<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Suri Cosméticos</title>
<style>
body { font-family: Arial, sans-serif; background: #ffe6f0; margin:0; padding:0; }
header { background: #f06292; color:#fff; padding:15px; text-align:center; font-size:24px; font-weight:bold; }
nav { display:flex; justify-content:center; gap:8px; margin:15px 0; }
nav button { padding:8px 14px; border:1px solid #f06292; background:#fff; color:#f06292; border-radius:5px; cursor:pointer; font-weight:bold; }
nav button.ativo, nav button:hover { background:#f06292; color:#fff; }
.aba { display:none; padding:20px; }
.ativa { display:block; }
table { width:100%; border-collapse: collapse; margin-top:10px; }
th, td { border:1px solid #f06292; padding:6px; text-align:center; }
th { background:#f48fb1; color:#fff; }
input, textarea, select { width:100%; padding:6px; margin:4px 0; border:1px solid #ccc; border-radius:5px; }
button.salvar { background:#f06292; color:#fff; border:none; padding:8px 14px; border-radius:5px; cursor:pointer; margin-top:8px; }
button.salvar:hover { background:#ec407a; }
.total { font-weight:bold; margin-top:10px; color:#880e4f; }
</style>
</head>
<body>
<header>Suri Cosméticos</header>
<nav>
<button onclick="mostrarAba('produtos', this)">Produtos</button>
<button onclick="mostrarAba('clientes', this)">Clientes</button>
<button onclick="mostrarAba('entradas', this)">Entradas</button>
<button onclick="mostrarAba('vendas', this)">Vendas</button>
<button onclick="mostrarAba('financeiro', this)">Financeiro</button>
<button onclick="mostrarAba('config', this)">Configurações</button>
</nav>

<!-- Produtos -->
<div id="produtos" class="aba ativa">
<h2>Cadastro de Produtos</h2>
<input id="nomeProduto" placeholder="Nome">
<textarea id="descricaoProduto" placeholder="Descrição"></textarea>
<input type="text" id="marcaProduto" placeholder="Marca">
<button class="salvar" onclick="salvarProduto()">Salvar</button>
<h3>Lista de Produtos</h3>
<table>
<thead><tr><th>Nome</th><th>Descrição</th><th>Marca</th><th>Estoque</th><th>Ações</th></tr></thead>
<tbody id="listaProdutos"></tbody>
</table>
</div>

<!-- Clientes -->
<div id="clientes" class="aba">
<h2>Cadastro de Clientes</h2>
<input id="nomeCliente" placeholder="Nome">
<input id="telefoneCliente" placeholder="Telefone">
<input type="email" id="emailCliente" placeholder="Email">
<button class="salvar" onclick="salvarCliente()">Salvar</button>
<h3>Lista de Clientes</h3>
<table>
<thead><tr><th>Nome</th><th>Telefone</th><th>Email</th><th>Ações</th></tr></thead>
<tbody id="listaClientes"></tbody>
</table>
</div>

<!-- Entradas -->
<div id="entradas" class="aba">
<h2>Entrada de Material</h2>
<select id="produtoEntrada"></select>
<input type="number" id="quantidadeEntrada" placeholder="Quantidade">
<input type="number" id="valorEntrada" placeholder="Valor Total">
<input type="date" id="dataEntrada">
<button class="salvar" onclick="salvarEntrada()">Registrar Entrada</button>
<h3>Histórico de Entradas</h3>
<table><thead><tr><th>Produto</th><th>Qtd</th><th>Valor</th><th>Data</th><th>Ações</th></tr></thead>
<tbody id="listaEntradas"></tbody>
</table>
</div>

<!-- Vendas -->
<div id="vendas" class="aba">
<h2>Registrar Venda</h2>
<select id="clienteVenda"></select>
<select id="produtoVenda"></select>
<input type="number" id="quantidadeVenda" placeholder="Quantidade">
<select id="tipoPagamento" onchange="toggleParcelas()">
<option value="avista">À vista</option>
<option value="parcelado">Parcelado</option>
</select>
<div id="parcelasDiv" style="display:none;">
  <input type="number" id="numParcelas" placeholder="Número de parcelas" min="1" onchange="gerarParcelas()">
  <div id="parcelasContainer"></div>
</div>
<button class="salvar" onclick="registrarVenda()">Registrar Venda</button>
<h3>Histórico de Vendas</h3>
<ul id="listaVendas"></ul>
</div>

<!-- Financeiro -->
<div id="financeiro" class="aba">
<h2>Financeiro</h2>
<label>Filtrar por Status:</label>
<select id="filtroFinanceiro" onchange="listarFinanceiro()">
<option value="">Todos</option>
<option value="Pendente">Pendentes</option>
<option value="Pago">Recebidos</option>
</select>
<table>
<thead><tr><th>Cliente</th><th>Produto</th><th>Qtd</th><th>Parcela</th><th>Valor</th><th>Vencimento</th><th>Status</th><th>Ações</th></tr></thead>
<tbody id="listaFinanceiro"></tbody>
</table>
</div>

<!-- Configurações -->
<div id="config" class="aba">
<h2>Configurações</h2>
<button onclick="baixarBackup()">📥 Baixar Backup</button>
<input type="file" id="inputBackup" onchange="importarBackup(event)">
</div>

<script>
let produtos = JSON.parse(localStorage.getItem("produtos"))||[];
let clientes = JSON.parse(localStorage.getItem("clientes"))||[];
let entradas = JSON.parse(localStorage.getItem("entradas"))||[];
let vendas = JSON.parse(localStorage.getItem("vendas"))||[];
const senhaExclusao = "1234";

function mostrarAba(aba, botao){
  document.querySelectorAll(".aba").forEach(d=>d.classList.remove("ativa"));
  document.getElementById(aba).classList.add("ativa");
  document.querySelectorAll("nav button").forEach(b=>b.classList.remove("ativo"));
  botao.classList.add("ativo");
  atualizarSelects();
  listarProdutos(); listarClientes(); listarEntradas(); listarVendas(); listarFinanceiro();
}

// Produtos
function salvarProduto(){
  const nome=document.getElementById("nomeProduto").value;
  const desc=document.getElementById("descricaoProduto").value;
  const marca=document.getElementById("marcaProduto").value;
  if(nome){produtos.push({nome,desc,marca,estoque:0});
  localStorage.setItem("produtos",JSON.stringify(produtos));
  document.getElementById("nomeProduto").value=""; document.getElementById("descricaoProduto").value=""; document.getElementById("marcaProduto").value="";
  listarProdutos();}
}
function listarProdutos(){
  const tb=document.getElementById("listaProdutos"); tb.innerHTML="";
  produtos.forEach((p,i)=>{tb.innerHTML+=`<tr><td>${p.nome}</td><td>${p.desc}</td><td>${p.marca}</td><td>${p.estoque}</td>
  <td><button onclick="excluirProduto(${i})">Excluir</button></td></tr>`;});
}
function excluirProduto(i){ if(prompt("Senha?")===senhaExclusao){produtos.splice(i,1);localStorage.setItem("produtos",JSON.stringify(produtos));listarProdutos();}}

// Clientes
function salvarCliente(){
  const nome=document.getElementById("nomeCliente").value;
  const tel=document.getElementById("telefoneCliente").value;
  const email=document.getElementById("emailCliente").value;
  if(nome){clientes.push({nome,tel,email});
  localStorage.setItem("clientes",JSON.stringify(clientes));
  document.getElementById("nomeCliente").value=""; document.getElementById("telefoneCliente").value=""; document.getElementById("emailCliente").value="";
  listarClientes();}
}
function listarClientes(){
  const tb=document.getElementById("listaClientes"); tb.innerHTML="";
  clientes.forEach((c,i)=>{tb.innerHTML+=`<tr><td>${c.nome}</td><td>${c.tel}</td><td>${c.email}</td>
  <td><button onclick="excluirCliente(${i})">Excluir</button></td></tr>`;});
}

// Entradas
function salvarEntrada(){
  const pi=document.getElementById("produtoEntrada").value;
  const q=parseInt(document.getElementById("quantidadeEntrada").value);
  const v=parseFloat(document.getElementById("valorEntrada").value);
  const d=document.getElementById("dataEntrada").value;
  if(pi!==""&&q>0){produtos[pi].estoque+=q; entradas.push({produto:produtos[pi].nome,q,v,d});
  localStorage.setItem("produtos",JSON.stringify(produtos));
  localStorage.setItem("entradas",JSON.stringify(entradas));
  document.getElementById("quantidadeEntrada").value=""; document.getElementById("valorEntrada").value=""; document.getElementById("dataEntrada").value="";
  listarEntradas(); listarProdutos();}
}
function listarEntradas(){
  const tb=document.getElementById("listaEntradas"); tb.innerHTML="";
  entradas.forEach((e,i)=>{tb.innerHTML+=`<tr><td>${e.produto}</td><td>${e.q}</td><td>R$${e.v}</td><td>${e.d}</td>
  <td><button onclick="excluirEntrada(${i})">Excluir</button></td></tr>`;});
}
function excluirEntrada(i){ if(prompt("Senha?")===senhaExclusao){entradas.splice(i,1);localStorage.setItem("entradas",JSON.stringify(entradas));listarEntradas();}}

// Vendas
function toggleParcelas(){
  const tipo=document.getElementById("tipoPagamento").value;
  document.getElementById("parcelasDiv").style.display=(tipo==="parcelado")?"block":"none";
  document.getElementById("parcelasContainer").innerHTML="";
}
function gerarParcelas(){
  const num=parseInt(document.getElementById("numParcelas").value);
  const container=document.getElementById("parcelasContainer");
  container.innerHTML="";
  for(let i=0;i<num;i++){
    container.innerHTML+=`<div>Parcela ${i+1}: <input type="number" placeholder="Valor" class="valorParcela"> <input type="date" class="dataParcela"></div>`;
  }
}
function registrarVenda(){
  const ci=document.getElementById("clienteVenda").value;
  const pi=document.getElementById("produtoVenda").value;
  const q=parseInt(document.getElementById("quantidadeVenda").value);
  const tipo=document.getElementById("tipoPagamento").value;
  if(ci!==""&&pi!==""&&q>0){
    if(produtos[pi].estoque>=q){
      produtos[pi].estoque-=q;
      let parcelas=[];
      let total=0;
      if(tipo==="avista"){
        total=q*10;
        parcelas.push({valor:total,data:new Date().toISOString().split("T")[0],status:"Pendente"});
      }else{
        const vals=document.querySelectorAll(".valorParcela");
        const datas=document.querySelectorAll(".dataParcela");
        for(let i=0;i<vals.length;i++){
          const v=parseFloat(vals[i].value);
          const d=datas[i].value;
          if(!v||!d){alert("Informe todos os valores e datas das parcelas"); return;}
          parcelas.push({valor:v,data:d,status:"Pendente"});
          total+=v;
        }
      }
      vendas.push({cliente:clientes[ci].nome,produto:produtos[pi].nome,q,total,parcelas});
      localStorage.setItem("produtos",JSON.stringify(produtos));
      localStorage.setItem("vendas",JSON.stringify(vendas));
      document.getElementById("quantidadeVenda").value=""; document.getElementById("tipoPagamento").value="avista";
      document.getElementById("numParcelas").value=""; document.getElementById("parcelasContainer").innerHTML="";
      listarProdutos(); listarVendas(); listarFinanceiro();
    }else alert("Estoque insuficiente");
  }
}
function listarVendas(){
  const ul=document.getElementById("listaVendas"); ul.innerHTML="";
  vendas.forEach((v,i)=>{
    let info=v.parcelas.map((p,j)=>`Parcela ${j+1}: R$${p.valor} - ${p.data} (${p.status})`).join(", ");
    ul.innerHTML+=`<li>${v.cliente} comprou ${v.q}x ${v.produto} - Total: R$${v.total} <br>${info}
    <button onclick="excluirVenda(${i})">Excluir</button></li>`;
  });
}
function excluirVenda(i){ if(prompt("Senha?")===senhaExclusao){vendas.splice(i,1);localStorage.setItem("vendas",JSON.stringify(vendas));listarVendas(); listarFinanceiro();}}

// Financeiro
function listarFinanceiro(){
  const tb=document.getElementById("listaFinanceiro"); tb.innerHTML="";
  const filtro=document.getElementById("filtroFinanceiro")?.value||"";
  vendas.forEach((v,vi)=>{
    v.parcelas.forEach((p,pi)=>{
      if(filtro&&p.status!==filtro) return;
      tb.innerHTML+=`<tr><td>${v.cliente}</td><td>${v.produto}</td><td>${v.q}</td><td>${pi+1}</td><td>R$${p.valor}</td><td>${p.data}</td><td>${p.status}</td>
      <td><button onclick="receberParcela(${vi},${pi})">Receber</button></td></tr>`;
    });
  });
}
function receberParcela(vi,pi){vendas[vi].parcelas[pi].status="Pago";localStorage.setItem("vendas",JSON.stringify(vendas));listarFinanceiro();}

// Selects
function atualizarSelects(){
  let sp=document.getElementById("produtoEntrada"); sp.innerHTML=""; produtos.forEach((p,i)=>sp.innerHTML+=`<option value="${i}">${p.nome}</option>`);
  let spv=document.getElementById("produtoVenda"); spv.innerHTML=""; produtos.forEach((p,i)=>spv.innerHTML+=`<option value="${i}">${p.nome}</option>`);
  let sc=document.getElementById("clienteVenda"); sc.innerHTML=""; clientes.forEach((c,i)=>sc.innerHTML+=`<option value="${i}">${c.nome}</option>`);
}

// Backup
function baixarBackup(){
  const data={produtos,clientes,entradas,vendas};
  const blob=new Blob([JSON.stringify(data)],{type:"application/json"});
  const a=document.createElement("a"); a.href=URL.createObjectURL(blob); a.download="backup.json"; a.click();
}
function importarBackup(ev){
  const f=ev.target.files[0]; const r=new FileReader();
  r.onload=e=>{const d=JSON.parse(e.target.result);
    produtos=d.produtos||[];clientes=d.clientes||[];entradas=d.entradas||[];vendas=d.vendas||[];
    localStorage.setItem("produtos",JSON.stringify(produtos));
    localStorage.setItem("clientes",JSON.stringify(clientes));
    localStorage.setItem("entradas",JSON.stringify(entradas));
    localStorage.setItem("vendas",JSON.stringify(vendas));
    listarProdutos();listarClientes();listarEntradas();listarVendas();listarFinanceiro();
  }; r.readAsText(f);
}

// Inicializar
listarProdutos(); listarClientes(); listarEntradas(); listarVendas(); listarFinanceiro();
atualizarSelects();
</script>
</body>
</html>
