<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Suri Cosméticos</title>
<style>
    body { font-family: Arial, sans-serif; background: #f0f0f0; color: #333; margin:0; padding:0; }
    header { background: #d32f2f; color: white; padding: 10px 20px; font-size: 24px; }
    nav { display: flex; background: #b71c1c; }
    nav button { flex: 1; padding: 10px; background: none; border: none; color: white; cursor: pointer; font-weight: bold; }
    nav button.active { background: #e53935; }
    section { padding: 20px; display: none; }
    table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background: #eee; }
    .btn { padding: 5px 10px; cursor: pointer; border: none; border-radius: 4px; }
    .btn-delete { background: #e53935; color: white; }
    .btn-edit { background: #fbc02d; color: white; }
    .btn-paid { background: #43a047; color: white; }
    .btn-open { background: #f57c00; color: white; }
    .filter-btn { padding: 5px 10px; margin-right: 5px; cursor: pointer; border-radius: 4px; border: none; }
    .filter-paid { background: #43a047; color: white; }
    .filter-open { background: #f57c00; color: white; }
    .hidden { display: none; }
</style>
</head>
<body>

<header>Suri Cosméticos</header>
<nav>
    <button class="tab-btn active" data-tab="produtos">Produtos</button>
    <button class="tab-btn" data-tab="entrada">Entrada</button>
    <button class="tab-btn" data-tab="venda">Venda</button>
    <button class="tab-btn" data-tab="clientes">Clientes</button>
</nav>

<!-- PRODUTOS -->
<section id="produtos" style="display:block;">
    <h2>Produtos</h2>
    <input type="text" id="produtoNome" placeholder="Nome do Produto">
    <input type="number" id="produtoValor" placeholder="Valor Unitário" step="0.01">
    <button class="btn" id="addProduto">Adicionar Produto</button>
    <table id="produtosTable">
        <thead>
            <tr>
                <th>Produto</th>
                <th>Valor</th>
                <th>Saldo</th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</section>

<!-- ENTRADA -->
<section id="entrada">
    <h2>Entrada de Produtos</h2>
    <select id="entradaProduto"></select>
    <input type="number" id="entradaQuantidade" placeholder="Quantidade">
    <input type="text" id="entradaNota" placeholder="Nota Fiscal">
    <button class="btn" id="addEntrada">Adicionar Entrada</button>
    <table id="entradaTable">
        <thead>
            <tr>
                <th>Produto</th>
                <th>Quantidade</th>
                <th>Nota Fiscal</th>
                <th>Data</th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</section>

<!-- VENDA -->
<section id="venda">
    <h2>Vendas</h2>
    <select id="vendaCliente"></select>
    <select id="vendaProduto"></select>
    <input type="number" id="vendaQuantidade" placeholder="Quantidade">
    <input type="number" id="vendaParcelas" placeholder="Número de Parcelas" min="1" value="1">
    <input type="date" id="vendaData" placeholder="Data">
    <button class="btn" id="addVenda">Registrar Venda</button>
    
    <div style="margin-top:10px;">
        <button class="filter-btn filter-paid" onclick="filterVendas('Pago')">Pago</button>
        <button class="filter-btn filter-open" onclick="filterVendas('Em Aberto')">Em Aberto</button>
        <button class="filter-btn" onclick="filterVendas('Todos')">Todos</button>
        <button class="filter-btn" onclick="exportPDF('vendaTable','Relatório de Vendas')">Exportar PDF</button>
    </div>

    <table id="vendaTable">
        <thead>
            <tr>
                <th>Cliente</th>
                <th>Produto</th>
                <th>Quantidade</th>
                <th>Parcelas</th>
                <th>Data</th>
                <th>Status</th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</section>

<!-- CLIENTES -->
<section id="clientes">
    <h2>Clientes</h2>
    <input type="text" id="clienteNome" placeholder="Nome do Cliente">
    <button class="btn" id="addCliente">Adicionar Cliente</button>
    <table id="clientesTable">
        <thead>
            <tr>
                <th>Cliente</th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</section>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
const senha = '1234';

// Dados
let produtos = [];
let entradas = [];
let vendas = [];
let clientes = [];

// Funções de abas
document.querySelectorAll('.tab-btn').forEach(btn => {
    btn.addEventListener('click', () => {
        document.querySelectorAll('section').forEach(sec => sec.style.display='none');
        document.querySelector(`#${btn.dataset.tab}`).style.display='block';
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
    });
});

// Produtos
function updateProdutos() {
    const tbody = document.querySelector('#produtosTable tbody');
    tbody.innerHTML = '';
    const entradaSelect = document.getElementById('entradaProduto');
    const vendaSelect = document.getElementById('vendaProduto');
    entradaSelect.innerHTML = '';
    vendaSelect.innerHTML = '';
    produtos.forEach((p, i) => {
        let tr = document.createElement('tr');
        let saldo = entradas.filter(e => e.produto===p.nome).reduce((acc,e)=>acc+e.quantidade,0)
                  - vendas.filter(v=>v.produto===p.nome).reduce((acc,v)=>acc+v.quantidade,0);
        tr.innerHTML = `<td>${p.nome}</td><td>${p.valor.toFixed(2)}</td><td>${saldo}</td>
            <td>
            <button class="btn btn-edit" onclick="editarProduto(${i})">Editar</button>
            <button class="btn btn-delete" onclick="excluirProduto(${i})">Excluir</button>
            </td>`;
        tbody.appendChild(tr);
        let option1 = document.createElement('option'); option1.value=p.nome; option1.text=p.nome; entradaSelect.add(option1);
        let option2 = document.createElement('option'); option2.value=p.nome; option2.text=p.nome; vendaSelect.add(option2);
    });
}
function addProduto() {
    let nome = document.getElementById('produtoNome').value;
    let valor = parseFloat(document.getElementById('produtoValor').value);
    if(nome && valor){ produtos.push({nome,valor}); updateProdutos(); document.getElementById('produtoNome').value=''; document.getElementById('produtoValor').value=''; }
}
function editarProduto(i){
    let senhaInput = prompt('Digite a senha para alterar:');
    if(senhaInput!==senha) return alert('Senha incorreta');
    let novoNome = prompt('Novo nome:', produtos[i].nome);
    let novoValor = parseFloat(prompt('Novo valor:', produtos[i].valor));
    if(novoNome && !isNaN(novoValor)){ produtos[i]={nome:novoNome,valor:novoValor}; updateProdutos(); }
}
function excluirProduto(i){
    let senhaInput = prompt('Digite a senha para excluir:');
    if(senhaInput!==senha) return alert('Senha incorreta');
    produtos.splice(i,1); updateProdutos();
}
document.getElementById('addProduto').addEventListener('click', addProduto);

// Clientes
function updateClientes() {
    const tbody = document.querySelector('#clientesTable tbody');
    tbody.innerHTML = '';
    const clienteSelect = document.getElementById('vendaCliente');
    clienteSelect.innerHTML = '';
    clientes.forEach((c,i)=>{
        let tr = document.createElement('tr');
        tr.innerHTML = `<td>${c.nome}</td>
        <td>
            <button class="btn btn-edit" onclick="editarCliente(${i})">Editar</button>
            <button class="btn btn-delete" onclick="excluirCliente(${i})">Excluir</button>
        </td>`;
        tbody.appendChild(tr);
        let option = document.createElement('option'); option.value=c.nome; option.text=c.nome; clienteSelect.add(option);
    });
}
function addCliente(){
    let nome = document.getElementById('clienteNome').value;
    if(nome){ clientes.push({nome}); updateClientes(); document.getElementById('clienteNome').value=''; }
}
function editarCliente(i){
    let senhaInput = prompt('Digite a senha para alterar:');
    if(senhaInput!==senha) return alert('Senha incorreta');
    let novoNome = prompt('Novo nome:', clientes[i].nome);
    if(novoNome){ clientes[i].nome=novoNome; updateClientes(); }
}
function excluirCliente(i){
    let senhaInput = prompt('Digite a senha para excluir:');
    if(senhaInput!==senha) return alert('Senha incorreta');
    clientes.splice(i,1); updateClientes();
}
document.getElementById('addCliente').addEventListener('click', addCliente);

// Entrada
function updateEntradas(){
    const tbody = document.querySelector('#entradaTable tbody');
    tbody.innerHTML = '';
    entradas.forEach((e,i)=>{
        let tr = document.createElement('tr');
        tr.innerHTML = `<td>${e.produto}</td><td>${e.quantidade}</td><td>${e.nota}</td><td>${e.data}</td>
        <td>
            <button class="btn btn-delete" onclick="excluirEntrada(${i})">Excluir</button>
        </td>`;
        tbody.appendChild(tr);
    });
    updateProdutos();
}
function addEntrada(){
    const produto = document.getElementById('entradaProduto').value;
    const quantidade = parseInt(document.getElementById('entradaQuantidade').value);
    const nota = document.getElementById('entradaNota').value;
    const data = new Date().toLocaleDateString();
    if(produto && quantidade && nota){ entradas.push({produto,quantidade,nota,data}); updateEntradas(); document.getElementById('entradaQuantidade').value=''; document.getElementById('entradaNota').value=''; }
}
function excluirEntrada(i){
    let senhaInput = prompt('Digite a senha para excluir:');
    if(senhaInput!==senha) return alert('Senha incorreta');
    entradas.splice(i,1); updateEntradas();
}
document.getElementById('addEntrada').addEventListener('click', addEntrada);

// Vendas
function updateVendas(filter='Todos'){
    const tbody = document.querySelector('#vendaTable tbody');
    tbody.innerHTML = '';
    vendas.forEach((v,i)=>{
        if(filter!=='Todos' && v.status!==filter) return;
        let tr = document.createElement('tr');
        tr.innerHTML = `<td>${v.cliente}</td><td>${v.produto}</td><td>${v.quantidade}</td>
        <td>${v.parcelas}</td><td>${v.data}</td>
        <td><button class="btn ${v.status==='Pago'?'btn-paid':'btn-open'}" onclick="toggleStatus(${i})">${v.status}</button></td>
        <td>
            <button class="btn btn-delete" onclick="excluirVenda(${i})">Excluir</button>
        </td>`;
        tbody.appendChild(tr);
    });
    updateProdutos();
}
function addVenda(){
    const cliente = document.getElementById('vendaCliente').value;
    const produto = document.getElementById('vendaProduto').value;
    const quantidade = parseInt(document.getElementById('vendaQuantidade').value);
    const parcelas = parseInt(document.getElementById('vendaParcelas').value);
    const data = document.getElementById('vendaData').value || new Date().toLocaleDateString();
    if(cliente && produto && quantidade && parcelas){ vendas.push({cliente,produto,quantidade,parcelas,data,status:'Em Aberto'}); updateVendas(); document.getElementById('vendaQuantidade').value=''; document.getElementById('vendaParcelas').value='1'; }
}
function toggleStatus(i){
    let senhaInput = prompt('Digite a senha para alterar o status:');
    if(senhaInput!==senha) return alert('Senha incorreta');
    vendas[i].status = vendas[i].status==='Pago'?'Em Aberto':'Pago';
    updateVendas();
}
function excluirVenda(i){
    let senhaInput = prompt('Digite a senha para excluir:');
    if(senhaInput!==senha) return alert('Senha incorreta');
    vendas.splice(i,1); updateVendas();
}
function filterVendas(status){
    updateVendas(status);
}
document.getElementById('addVenda').addEventListener('click', addVenda);

// Exportar PDF
function exportPDF(tableId,title){
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    doc.setFontSize(14);
    doc.text(title, 10, 10);
    let table = document.getElementById(tableId);
    let rows = [];
    for(let i=1;i<table.rows.length;i++){
        let row = [];
        for(let j=0;j<table.rows[i].cells.length-1;j++){ // ignora coluna ações
            row.push(table.rows[i].cells[j].innerText);
        }
        rows.push(row);
    }
    doc.autoTable({ head:[Array.from(table.rows[0].cells).slice(0,-1).map(c=>c.innerText)], body: rows, startY:20 });
    doc.save(title+'.pdf');
}

// Inicialização
updateProdutos();
updateClientes();
updateEntradas();
updateVendas();
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
</body>
</html>
