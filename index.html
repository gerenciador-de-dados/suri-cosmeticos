<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Suri Cosméticos</title>
<style>
body { font-family: Arial; background: #ffe6f0; margin:0; padding:0; }
header { background: #f06292; color:#fff; padding:15px; text-align:center; font-size:24px; font-weight:bold; }
nav { display:flex; justify-content:center; gap:8px; margin:15px 0; }
nav button { padding:8px 14px; border:1px solid #f06292; background:#fff; color:#f06292; border-radius:5px; cursor:pointer; font-weight:bold; }
nav button.ativo, nav button:hover { background:#f06292; color:#fff; }
.aba { display:none; padding:20px; }
.ativa { display:block; }
table { width:100%; border-collapse: collapse; margin-top:10px; }
th, td { border:1px solid #f06292; padding:6px; text-align:center; }
th { background:#f48fb1; color:#fff; }
input, textarea, select { width:100%; padding:6px; margin:4px 0; border:1px solid #ccc; border-radius:5px; }
button.salvar { background:#f06292; color:#fff; border:none; padding:8px 14px; border-radius:5px; cursor:pointer; margin-top:8px; }
button.salvar:hover { background:#ec407a; }
.total { font-weight:bold; margin-top:10px; color:#880e4f; }
</style>
</head>
<body>
<header>Suri Cosméticos</header>
<nav>
<button onclick="mostrarAba('produtos', this)">Produtos</button>
<button onclick="mostrarAba('clientes', this)">Clientes</button>
<button onclick="mostrarAba('entradas', this)">Entradas</button>
<button onclick="mostrarAba('vendas', this)">Vendas</button>
<button onclick="mostrarAba('financeiro', this)">Financeiro</button>
<button onclick="mostrarAba('config', this)">Configurações</button>
</nav>

<!-- Produtos -->
<div id="produtos" class="aba ativa">
<h2>Cadastro de Produtos</h2>
<input id="nomeProduto" placeholder="Nome">
<textarea id="descricaoProduto" placeholder="Descrição"></textarea>
<input type="text" id="marcaProduto" placeholder="Marca">
<button class="salvar" onclick="salvarProduto()">Salvar</button>
<h3>Lista de Produtos</h3>
<table>
<thead><tr><th>Nome</th><th>Descrição</th><th>Marca</th><th>Estoque</th><th>Ações</th></tr></thead>
<tbody id="listaProdutos"></tbody>
</table>
</div>

<!-- Clientes -->
<div id="clientes" class="aba">
<h2>Cadastro de Clientes</h2>
<input id="nomeCliente" placeholder="Nome">
<input id="telefoneCliente" placeholder="Telefone">
<input type="email" id="emailCliente" placeholder="Email">
<button class="salvar" onclick="salvarCliente()">Salvar</button>
<h3>Lista de Clientes</h3>
<table>
<thead><tr><th>Nome</th><th>Telefone</th><th>Email</th><th>Ações</th></tr></thead>
<tbody id="listaClientes"></tbody>
</table>
</div>

<!-- Entradas -->
<div id="entradas" class="aba">
<h2>Entrada de Material</h2>
<select id="produtoEntrada"></select>
<input type="number" id="quantidadeEntrada" placeholder="Quantidade">
<input type="number" id="valorEntrada" placeholder="Valor Total">
<input type="date" id="dataEntrada">
<button class="salvar" onclick="salvarEntrada()">Registrar Entrada</button>
<h3>Histórico de Entradas</h3>
<table><thead><tr><th>Produto</th><th>Qtd</th><th>Valor</th><th>Data</th><th>Ações</th></tr></thead>
<tbody id="listaEntradas"></tbody>
</table>
</div>

<!-- Vendas -->
<div id="vendas" class="aba">
<h2>Registrar Venda</h2>
<select id="clienteVenda"></select>
<select id="produtoVenda"></select>
<input type="number" id="quantidadeVenda" placeholder="Quantidade">
<select id="tipoPagamento" onchange="toggleParcelas()">
<option value="avista">À vista</option>
<option value="parcelado">Parcelado</option>
</select>
<div id="parcelasDiv" style="display:none;">
  <input type="number" id="numParcelas" placeholder="Número de parcelas" min="1" onchange="gerarParcelas()">
  <div id="parcelasContainer"></div>
</div>
<button class="salvar" onclick="registrarVenda()">Registrar Venda</button>
<h3>Histórico de Vendas</h3>
<ul id="listaVendas"></ul>
</div>

<!-- Financeiro -->
<div id="financeiro" class="aba">
<h2>Financeiro</h2>
<label>Filtrar por Status:</label>
<select id="filtroFinanceiro" onchange="listarFinanceiro()">
<option value="">Todos</option>
<option value="Pendente">Pendentes</option>
<option value="Pago">Recebidos</option>
</select>
<table>
<thead><tr><th>Cliente</th><th>Produto</th><th>Qtd</th><th>Parcela</th><th>Valor</th><th>Vencimento</th><th>Status</th><th>Ações</th></tr></thead>
<tbody id="listaFinanceiro"></tbody>
</table>
</div>

<!-- Configurações -->
<div id="config" class="aba">
<h2>Configurações</h2>
<button onclick="baixarBackup()">📥 Baixar Backup</button>
<input type="file" id="inputBackup" onchange="importarBackup(event)">
</div>

<script>
let produtos = JSON.parse(localStorage.getItem("produtos"))||[];
let clientes = JSON.parse(localStorage.getItem("clientes"))||[];
let entradas = JSON.parse(localStorage.getItem("entradas"))||[];
let vendas = JSON.parse(localStorage.getItem("vendas"))||[];
const senhaExclusao = "1234";

function mostrarAba(aba, botao){
  document.querySelectorAll(".aba").forEach(d=>d.classList.remove("ativa"));
  document.getElementById(aba).classList.add("ativa");
  document.querySelectorAll("nav button").forEach(b=>b.classList.remove("ativo"));
  botao.classList.add("ativo");
  atualizarSelects();
  listarProdutos(); listarClientes(); listarEntradas(); listarVendas(); listarFinanceiro();
}

// Produtos
function salvarProduto(){
  const nome=document.getElementById("nomeProduto").value;
  const desc=document.getElementById("descricaoProduto").value;
  const marca=document.getElementById("marcaProduto").value;
  if(nome){
    produtos.push({nome,desc,marca,estoque:0});
    localStorage.setItem("produtos",JSON.stringify(produtos));
    document.getElementById("nomeProduto").value=""; document.getElementById("descricaoProduto").value=""; document.getElementById("marcaProduto").value="";
    listarProdutos();
  }
}
function listarProdutos(){
  const tb=document.getElementById("listaProdutos"); tb.innerHTML="";
  produtos.forEach((p,i)=>{
    tb.innerHTML+=`<tr>
    <td contenteditable="true" onblur="alterarProduto(${i})">${p.nome}</td>
    <td contenteditable="true" onblur="alterarProduto(${i})">${p.desc}</td>
    <td contenteditable="true" onblur="alterarProduto(${i})">${p.marca}</td>
    <td>${p.estoque}</td>
    <td><button onclick="excluirProduto(${i})">Excluir</button></td>
    </tr>`;
  });
}
function alterarProduto(i){
  if(prompt("Senha para alterar?")==senhaExclusao){
    const tds=document.getElementById("listaProdutos").rows[i].cells;
    produtos[i].nome=tds[0].innerText;
    produtos[i].desc=tds[1].innerText;
    produtos[i].marca=tds[2].innerText;
    localStorage.setItem("produtos",JSON.stringify(produtos));
    listarProdutos();
  } else {alert("Senha incorreta"); listarProdutos();}
}
function excluirProduto(i){ if(prompt("Senha para excluir?")===senhaExclusao){produtos.splice(i,1); localStorage.setItem("produtos",JSON.stringify(produtos)); listarProdutos();}}

// Clientes
function salvarCliente(){
  const nome=document.getElementById("nomeCliente").value;
  const tel=document.getElementById("telefoneCliente").value;
  const email=document.getElementById("emailCliente").value;
  if(nome){
    clientes.push({nome,tel,email});
    localStorage.setItem("clientes",JSON.stringify(clientes));
    document.getElementById("nomeCliente").value=""; document.getElementById("telefoneCliente").value=""; document.getElementById("emailCliente").value="";
    listarClientes();
  }
}
function listarClientes(){
  const tb=document.getElementById("listaClientes"); tb.innerHTML="";
  clientes.forEach((c,i)=>{
    tb.innerHTML+=`<tr>
    <td contenteditable="true" onblur="alterarCliente(${i})">${c.nome}</td>
    <td contenteditable="true" onblur="alterarCliente(${i})">${c.tel}</td>
    <td contenteditable="true" onblur="alterarCliente(${i})">${c.email}</td>
    <td><button onclick="excluirCliente(${i})">Excluir</button></td>
    </tr>`;
  });
}
function alterarCliente(i){
  if(prompt("Senha para alterar?")==senhaExclusao){
    const tds=document.getElementById("listaClientes").rows[i].cells;
    clientes[i].nome=tds[0].innerText;
    clientes[i].tel=tds[1].innerText;
    clientes[i].email=tds[2].innerText;
    localStorage.setItem("clientes",JSON.stringify(clientes));
    listarClientes();
  } else {alert("Senha incorreta"); listarClientes();}
}
function excluirCliente(i){ if(prompt("Senha para excluir?")===senhaExclusao){clientes.splice(i,1); localStorage.setItem("clientes",JSON.stringify(clientes)); listarClientes();}}

// Entradas
function salvarEntrada(){
  const pIndex=document.getElementById("produtoEntrada").value;
  const qtd=parseInt(document.getElementById("quantidadeEntrada").value);
  const val=parseFloat(document.getElementById("valorEntrada").value);
  const data=document.getElementById("dataEntrada").value;
  if(pIndex!=="" && qtd>0 && val>0 && data){
    entradas.push({produto:produtos[pIndex].nome,qtd,val,data});
    produtos[pIndex].estoque+=qtd;
    localStorage.setItem("entradas",JSON.stringify(entradas));
    localStorage.setItem("produtos",JSON.stringify(produtos));
    listarEntradas(); listarProdutos();
  }
}
function listarEntradas(){
  const tb=document.getElementById("listaEntradas"); tb.innerHTML="";
  entradas.forEach((e,i)=>{
    tb.innerHTML+=`<tr>
    <td>${e.produto}</td>
    <td>${e.qtd}</td>
    <td>${e.val.toFixed(2)}</td>
    <td>${e.data}</td>
    <td><button onclick="excluirEntrada(${i})">Excluir</button></td>
    </tr>`;
  });
}
function excluirEntrada(i){ if(prompt("Senha para excluir?")===senhaExclusao){entradas.splice(i,1); localStorage.setItem("entradas",JSON.stringify(entradas)); listarEntradas();}}

// Atualizar selects
function atualizarSelects(){
  const selProduto=document.getElementById("produtoEntrada");
  const selVendaProduto=document.getElementById("produtoVenda");
  const selVendaCliente=document.getElementById("clienteVenda");
  selProduto.innerHTML=selVendaProduto.innerHTML="";
  selVendaCliente.innerHTML="";
  produtos.forEach((p,i)=>{selProduto.innerHTML+=`<option value="${i}">${p.nome}</option>`; selVendaProduto.innerHTML+=`<option value="${i}">${p.nome}</option>`;});
  clientes.forEach((c,i)=>{selVendaCliente.innerHTML+=`<option value="${i}">${c.nome}</option>`;});
}

// Vendas
function toggleParcelas(){document.getElementById("parcelasDiv").style.display=document.getElementById("tipoPagamento").value=="parcelado"?"block":"none";}
function gerarParcelas(){const n=parseInt(document.getElementById("numParcelas").value); const div=document.getElementById("parcelasContainer"); div.innerHTML=""; for(let i=0;i<n;i++){div.innerHTML+=`<input type="date" placeholder="Vencimento parcela ${i+1}" id="vencimento${i}" style="margin-top:2px;">`;}}
function registrarVenda(){
  const cIndex=document.getElementById("clienteVenda").value;
  const pIndex=document.getElementById("produtoVenda").value;
  const qtd=parseInt(document.getElementById("quantidadeVenda").value);
  if(cIndex!=="" && pIndex!=="" && qtd>0){
    let parcelas=[]; let tipo=document.getElementById("tipoPagamento").value;
    if(tipo=="parcelado"){const n=parseInt(document.getElementById("numParcelas").value)||1; for(let i=0;i<n;i++){let d=document.getElementById(`vencimento${i}`).value; parcelas.push({vencimento:d,status:"Pendente"});}}
    vendas.push({cliente:clientes[cIndex].nome,produto:produtos[pIndex].nome,qtd,parcelas});
    produtos[pIndex].estoque-=qtd;
    localStorage.setItem("vendas",JSON.stringify(vendas)); localStorage.setItem("produtos",JSON.stringify(produtos));
    listarVendas(); listarProdutos(); listarFinanceiro();
  }
}
function listarVendas(){
  const ul=document.getElementById("listaVendas"); ul.innerHTML="";
  vendas.forEach((v,i)=>{
    let txt=`${v.cliente} comprou ${v.qtd} x ${v.produto}`;
    if(v.parcelas.length>0) txt+=" (parcelado)";
    ul.innerHTML+=`<li>${txt} <button onclick="excluirVenda(${i})">Excluir</button></li>`;
  });
}
function excluirVenda(i){if(prompt("Senha para excluir?")===senhaExclusao){vendas.splice(i,1); localStorage.setItem("vendas",JSON.stringify(vendas)); listarVendas(); listarFinanceiro();}}

// Financeiro
function listarFinanceiro(){
  const filtro=document.getElementById("filtroFinanceiro").value;
  const tb=document.getElementById("listaFinanceiro"); tb.innerHTML="";
  vendas.forEach((v,vi)=>{
    v.parcelas.forEach((par,pi)=>{
      if(filtro=="" || par.status==filtro)
        tb.innerHTML+=`<tr>
        <td>${v.cliente}</td><td>${v.produto}</td><td>${v.qtd}</td>
        <td>${pi+1}/${v.parcelas.length}</td>
        <td>${(v.qtd>0?0:0).toFixed(2)}</td>
        <td contenteditable="true" onblur="alterarParcela(${vi},${pi})">${par.vencimento}</td>
        <td contenteditable="true" onblur="alterarStatusParcela(${vi},${pi})">${par.status}</td>
        <td><button onclick="excluirParcela(${vi},${pi})">Excluir</button></td>
        </tr>`;
    });
  });
}
function alterarParcela(vIndex,pIndex){if(prompt("Senha para alterar?")==senhaExclusao){vendas[vIndex].parcelas[pIndex].vencimento=document.getElementById("listaFinanceiro").rows[pIndex].cells[5].innerText; localStorage.setItem("vendas",JSON.stringify(vendas)); listarFinanceiro();}else{alert("Senha incorreta"); listarFinanceiro();}}
function alterarStatusParcela(vIndex,pIndex){if(prompt("Senha para alterar?")==senhaExclusao){vendas[vIndex].parcelas[pIndex].status=document.getElementById("listaFinanceiro").rows[pIndex].cells[6].innerText; localStorage.setItem("vendas",JSON.stringify(vendas)); listarFinanceiro();}else{alert("Senha incorreta"); listarFinanceiro();}}
function excluirParcela(vIndex,pIndex){if(prompt("Senha para excluir?")==senhaExclusao){vendas[vIndex].parcelas.splice(pIndex,1); localStorage.setItem("vendas",JSON.stringify(vendas)); listarVendas(); listarFinanceiro();}}

// Backup
function baixarBackup(){const data=JSON.stringify({produtos,clientes,entradas,vendas}); const blob=new Blob([data],{type:"application/json"}); const a=document.createElement("a"); a.href=URL.createObjectURL(blob); a.download="backup.json"; a.click();}
function importarBackup(event){const file=event.target.files[0]; const reader=new FileReader(); reader.onload=function(){const data=JSON.parse(reader.result); produtos=data.produtos||[]; clientes=data.clientes||[]; entradas=data.entradas||[]; vendas=data.vendas||[]; localStorage.setItem("produtos",JSON.stringify(produtos)); localStorage.setItem("clientes",JSON.stringify(clientes)); localStorage.setItem("entradas",JSON.stringify(entradas)); localStorage.setItem("vendas",JSON.stringify(vendas)); listarProdutos(); listarClientes(); listarEntradas(); listarVendas(); listarFinanceiro(); atualizarSelects();}; reader.readAsText(file);
}

// Inicialização
atualizarSelects(); listarProdutos(); listarClientes(); listarEntradas(); listarVendas(); listarFinanceiro();
</script>
</body>
</html>
